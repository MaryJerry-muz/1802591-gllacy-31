const modalButton=document.querySelector(".modal-button"),modal=document.querySelector(".callback-modal"),modalBackground=document.querySelector(".modal-wrapper"),closeButton=modal.querySelector(".modal-close"),form=modal.querySelector(".callback-form"),name=modal.querySelector('[name="callback-name"]'),email=modal.querySelector('[name="callback-email"]'),submitBtn=modal.querySelector(".submitBtn");let isStorageSupport=!0,storageName="",storageEmail="";try{storage=localStorage.getItem("name")}catch(e){isStorageSupport=!1}modalButton.addEventListener("click",function(){modal.classList.add("opened"),modalBackground.classList.add("modal-background"),isStorageSupport?(name.value=storage,email.focus()):name.focus()}),closeButton.addEventListener("click",function(){modal.classList.remove("opened"),modal.classList.remove("modal-error"),modalBackground.classList.remove("modal-background")}),form.addEventListener("submit",function(e){name.value&&email.value?isStorageSupport&&localStorage.setItem("name",name.value):(e.preventDefault(),modal.classList.remove("modal-error"),modal.offsetWidth=modal.offsetWidth,modal.classList.add("modal-error"))}),email.addEventListener("input",function(e){email.validity.typeMismatch?(email.setCustomValidity("Мороженое тает, котики негодуют, e-mail адрес некорректный"),submitBtn.onclick=function(){modal.classList.remove("modal-error"),modal.offsetWidth=modal.offsetWidth,modal.classList.add("modal-error")}):email.setCustomValidity("")}),window.addEventListener("keydown",function(e){"Escape"!==e.key&&"Esc"!==e.key||(e.preventDefault(),modal.classList.remove("opened"),modal.classList.remove("modal-error"),modalBackground.classList.remove("modal-background"))});